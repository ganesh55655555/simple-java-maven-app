pipeline{
    agent any
    environment{
        PATH = "/opt/maven/bin:$PATH"
        
    }
    stages{
        stage('build'){
            steps{
            echo "....build started..."
            sh "mvn clean install -Dmaven.test.skip=true"
            echo "...build completed...."
        }
    }
    stage('test'){
        steps{
            echo "......test started....."
            sh "mvn surefire-report:report"
            echo "...... test completed....."
            
        }
    }
    stage('sonarqube analysis'){
       environment{
           scannerhome = tool 'sonarqube-scanner'
       }

       steps{
           withSonarQubeEnv ('sonarqube-server'){
               sh "${scannerHome}/bin/sonar-scanner"

        
    }
    
}
}
}
}
